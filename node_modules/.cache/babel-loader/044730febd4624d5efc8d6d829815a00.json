{"ast":null,"code":"var _jsxFileName = \"/Users/rkarnik/Documents/personal/mayuri_code/breakless-react/src/components/files/ViewFiles.js\";\nimport React, { Component } from 'react';\nimport { Link } from \"react-router-dom\";\nimport { MDBTable, MDBTableBody, MDBTableHead } from 'mdbreact';\nimport { connect } from \"react-redux\";\nimport appConfig from \"../../config/app-config\";\nimport request from \"request\";\nimport './ViewFiles.css';\nimport cognitoUtils from \"../../lib/cognitoUtils\";\nimport DeleteButton from \"./DeleteButton\";\n\nconst uuid = require('uuidv4').default;\n\nconst mapStateToProps = state => {\n  return {\n    session: state.session\n  };\n};\n\nclass ViewFiles extends Component {\n  constructor(props, context) {\n    super(props, context);\n\n    this.deleteFileRow = index => {\n      let contacts = [...this.state.apiResponse];\n      console.log(\"contacts \", contacts);\n      contacts.splice(index, 1);\n      this.setState({\n        contacts\n      });\n    };\n\n    this.onSignOut = e => {\n      e.preventDefault();\n      cognitoUtils.signOutCognitoSession();\n    };\n\n    this.getColumnKeys = function () {\n      let columNames = [\"First Name\", \"Last Name\", \"Upload Time\", \"Updated Time\", \"Description\", \"File Name\", \"Delete\"];\n      return columNames;\n    };\n\n    this.getDataKeys = function () {\n      let dataKeys = [\"first_name\", \"last_name\", \"file_uploaded_at\", \"file_updated_at\", \"file_description\", \"user_file_name\", \"delete_button\"];\n      return dataKeys;\n    };\n\n    this.getHeader = function () {\n      var keys = this.getColumnKeys();\n      return keys.map((key, index) => {\n        return React.createElement(\"th\", {\n          key: key,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 96\n          },\n          __self: this\n        }, key.toUpperCase());\n      });\n    };\n\n    this.getRowsData = function () {\n      console.log(\"CALLING getRowsData\");\n      let isAPICallDone = this.state.apiStatus; // console.log(\"getRowsData myItems \",myItems);\n\n      console.log(\"isAPICallDone  \", isAPICallDone);\n\n      if (isAPICallDone === \"SUCCESS\") {\n        let myItems = JSON.parse(this.state.apiResponse);\n        let keys = this.getDataKeys();\n        console.log(\"INSIDE IF isAPICallDone getRowsData myItems length \", myItems.length);\n        console.log(\"INSIDE IF isAPICallDone getRowsData myItems  \", myItems);\n        return myItems.map((row, index) => {\n          console.log(\"row is \", row);\n          return React.createElement(\"tr\", {\n            key: index,\n            __source: {\n              fileName: _jsxFileName,\n              lineNumber: 120\n            },\n            __self: this\n          }, React.createElement(RenderRow, {\n            key: index,\n            data: row,\n            keys: keys,\n            __source: {\n              fileName: _jsxFileName,\n              lineNumber: 120\n            },\n            __self: this\n          }));\n        }); // myItems.map((myItem) => {\n        //     console.log(\"********* Iterating getRowsData myItem \",myItem);\n        // });\n      } else {\n        console.log(\" *********** EMPTY EMPTY ROW CREATED\");\n        return React.createElement(\"tr\", {\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 129\n          },\n          __self: this\n        });\n      }\n    };\n\n    this.state = {\n      apiStatus: 'Not called',\n      apiResponse: []\n    };\n    console.log(\"ViewFiles props \", props.location);\n    console.log(\"ViewFiles this.state \", this.state);\n    this.getHeader = this.getHeader.bind(this);\n    this.getRowsData = this.getRowsData.bind(this);\n    this.getColumnKeys = this.getColumnKeys.bind(this);\n    this.getDataKeys = this.getDataKeys.bind(this); // this.state = {\n    //     selectedFile: null,\n    //     typedText:'',\n    //     isUploadSuccess:'false'\n    //\n    // }\n  }\n\n  componentDidMount() {\n    if (this.props.session.isLoggedIn) {\n      // Call the API server GET /users endpoint with our JWT access token\n      console.log(\"ViewFiles componentDidMount this.props.session.credentials.idToken \", this.props.session.credentials.idToken);\n      const options = {\n        url: \"\".concat(appConfig.apiUri, \"/file_details\"),\n        headers: {\n          Authorization: \"Bearer \".concat(this.props.session.credentials.idToken)\n        }\n      };\n      this.setState({\n        apiStatus: 'Loading...'\n      });\n      request.get(options, (err, resp, body) => {\n        let apiStatus, apiResponse;\n\n        if (err) {\n          // is API server started and reachable?\n          apiStatus = 'Unable to reach API';\n          console.error(apiStatus + ': ' + err);\n        } else if (resp.statusCode !== 200) {\n          // API returned an error\n          apiStatus = 'Error response received';\n          apiResponse = body;\n          console.error(apiStatus + ': ' + JSON.stringify(resp));\n        } else {\n          apiStatus = 'SUCCESS';\n          apiResponse = body;\n          console.log(\"ViewFIles GET FILES API RESPONSE \", body); // this.setState({apiStatus:\"SUCCESS\",apiResponse:body});\n\n          console.log(\"ViewFIles componentDidMount state \", this.state);\n        }\n\n        this.setState({\n          apiStatus: apiStatus,\n          apiResponse: body\n        }); // this.setState({ apiStatus, apiResponse })\n      });\n    }\n  }\n\n  render() {\n    return React.createElement(\"div\", {\n      className: \"view-body\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 136\n      },\n      __self: this\n    }, this.props.session.isLoggedIn ? React.createElement(\"div\", {\n      className: \"container\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 138\n      },\n      __self: this\n    }, React.createElement(\"div\", {\n      className: \"row\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 139\n      },\n      __self: this\n    }, React.createElement(\"div\", {\n      className: \"col-md-3\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 140\n      },\n      __self: this\n    }, React.createElement(Link, {\n      to: \"/\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 141\n      },\n      __self: this\n    }, \"Home\")), React.createElement(\"div\", {\n      className: \"col-md-3\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 143\n      },\n      __self: this\n    }, React.createElement(Link, {\n      to: \"/files/upload\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 144\n      },\n      __self: this\n    }, \"Upload File\")), React.createElement(\"div\", {\n      className: \"col-md-3\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 146\n      },\n      __self: this\n    }, React.createElement(Link, {\n      to: \"/files/update\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 147\n      },\n      __self: this\n    }, \"Update Existing File\"))), React.createElement(MDBTable, {\n      className: \"table table-bordered\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 150\n      },\n      __self: this\n    }, React.createElement(MDBTableHead, {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 151\n      },\n      __self: this\n    }, React.createElement(\"tr\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 152\n      },\n      __self: this\n    }, this.getHeader())), React.createElement(MDBTableBody, {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 156\n      },\n      __self: this\n    }, this.getRowsData())), React.createElement(\"a\", {\n      className: \"Home-link\",\n      href: \"#\",\n      onClick: this.onSignOut,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 160\n      },\n      __self: this\n    }, \"Sign out\")) : React.createElement(\"div\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 163\n      },\n      __self: this\n    }, React.createElement(\"p\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 164\n      },\n      __self: this\n    }, \"You are not logged in.\"), React.createElement(\"a\", {\n      className: \"Home-link\",\n      href: cognitoUtils.getCognitoSignInUri(),\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 165\n      },\n      __self: this\n    }, \"Sign in\")));\n  }\n\n}\n\nconst RenderRow = props => {\n  console.log(\"RenderRow props \", props);\n  return props.keys.map((key, index) => {\n    console.log(\"props.data[key] \", props.data[key]);\n    console.log(\"key \", key);\n\n    if (key === 'user_file_name') {\n      let downloadUrl = appConfig.cloudfrontUri + props.data['unique_file_name'];\n      console.log(\"downloadUrl = \", downloadUrl);\n      return React.createElement(\"td\", {\n        key: uuid(),\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 181\n        },\n        __self: this\n      }, React.createElement(\"a\", {\n        href: downloadUrl,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 181\n        },\n        __self: this\n      }, \" \", props.data[key]));\n    } else if (key === 'delete_button') {\n      return React.createElement(\"td\", {\n        key: uuid(),\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 183\n        },\n        __self: this\n      }, React.createElement(DeleteButton, {\n        onClick: this.deleteFileRow(),\n        index: props.data['id'],\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 183\n        },\n        __self: this\n      }));\n    } else return React.createElement(\"td\", {\n      key: uuid(),\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 186\n      },\n      __self: this\n    }, props.data[key]);\n  });\n};\n\nexport default connect(mapStateToProps)(ViewFiles);","map":{"version":3,"sources":["/Users/rkarnik/Documents/personal/mayuri_code/breakless-react/src/components/files/ViewFiles.js"],"names":["React","Component","Link","MDBTable","MDBTableBody","MDBTableHead","connect","appConfig","request","cognitoUtils","DeleteButton","uuid","require","default","mapStateToProps","state","session","ViewFiles","constructor","props","context","deleteFileRow","index","contacts","apiResponse","console","log","splice","setState","onSignOut","e","preventDefault","signOutCognitoSession","getColumnKeys","columNames","getDataKeys","dataKeys","getHeader","keys","map","key","toUpperCase","getRowsData","isAPICallDone","apiStatus","myItems","JSON","parse","length","row","location","bind","componentDidMount","isLoggedIn","credentials","idToken","options","url","apiUri","headers","Authorization","get","err","resp","body","error","statusCode","stringify","render","getCognitoSignInUri","RenderRow","data","downloadUrl","cloudfrontUri"],"mappings":"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","sourcesContent":["import React, {Component} from 'react';\nimport {Link} from \"react-router-dom\";\nimport {MDBTable, MDBTableBody, MDBTableHead} from 'mdbreact';\nimport {connect} from \"react-redux\";\nimport appConfig from \"../../config/app-config\";\nimport request from \"request\";\nimport './ViewFiles.css'\nimport cognitoUtils from \"../../lib/cognitoUtils\";\nimport DeleteButton from \"./DeleteButton\";\n\nconst uuid = require('uuidv4').default;\nconst mapStateToProps = state => {\n    return {session: state.session}\n}\n\nclass ViewFiles extends Component {\n    constructor(props, context) {\n        super(props, context);\n        this.state = {apiStatus: 'Not called',apiResponse:[]}\n        console.log(\"ViewFiles props \", props.location);\n        console.log(\"ViewFiles this.state \", this.state);\n        this.getHeader = this.getHeader.bind(this);\n        this.getRowsData = this.getRowsData.bind(this);\n        this.getColumnKeys = this.getColumnKeys.bind(this);\n        this.getDataKeys = this.getDataKeys.bind(this);\n        // this.state = {\n        //     selectedFile: null,\n        //     typedText:'',\n        //     isUploadSuccess:'false'\n        //\n        // }\n    }\n\n    deleteFileRow = (index) => {\n        let contacts = [...this.state.apiResponse];\n        console.log(\"contacts \",contacts);\n        contacts.splice(index, 1);\n        this.setState({contacts});\n    }\n\n    onSignOut = (e) => {\n        e.preventDefault()\n        cognitoUtils.signOutCognitoSession()\n    }\n\n    componentDidMount() {\n\n        if (this.props.session.isLoggedIn) {\n            // Call the API server GET /users endpoint with our JWT access token\n            console.log(\"ViewFiles componentDidMount this.props.session.credentials.idToken \", this.props.session.credentials.idToken);\n            const options = {\n                url: `${appConfig.apiUri}/file_details`,\n                headers: {\n                    Authorization: `Bearer ${this.props.session.credentials.idToken}`\n                }\n            }\n\n            this.setState({apiStatus: 'Loading...'});\n            request.get(options, (err, resp, body) => {\n                let apiStatus, apiResponse\n                if (err) {\n                    // is API server started and reachable?\n                    apiStatus = 'Unable to reach API'\n                    console.error(apiStatus + ': ' + err)\n                } else if (resp.statusCode !== 200) {\n                    // API returned an error\n                    apiStatus = 'Error response received'\n                    apiResponse = body\n                    console.error(apiStatus + ': ' + JSON.stringify(resp))\n                } else {\n                    apiStatus = 'SUCCESS'\n                    apiResponse = body\n                    console.log(\"ViewFIles GET FILES API RESPONSE \", body);\n                    // this.setState({apiStatus:\"SUCCESS\",apiResponse:body});\n                    console.log(\"ViewFIles componentDidMount state \", this.state);\n                }\n                this.setState({apiStatus: apiStatus, apiResponse: body})\n                // this.setState({ apiStatus, apiResponse })\n            })\n        }\n    }\n\n    getColumnKeys = function () {\n        let columNames = [\"First Name\", \"Last Name\", \"Upload Time\", \"Updated Time\", \"Description\", \"File Name\",\"Delete\"];\n        return columNames;\n    }\n\n    getDataKeys = function () {\n        let dataKeys = [\"first_name\", \"last_name\", \"file_uploaded_at\", \"file_updated_at\", \"file_description\", \"user_file_name\",\"delete_button\"];\n        return dataKeys;\n    }\n\n    getHeader = function () {\n        var keys = this.getColumnKeys();\n        return keys.map((key, index) => {\n            return <th key={key}>{key.toUpperCase()}</th>\n        })\n    }\n\n    // getRowsData = function(){\n    //     var items = this.props.data;\n    //     var keys = this.getColumnKeys();\n    //     return items.map((row, index)=>{\n    //         return <tr key={index}><RenderRow key={index} data={row} keys={keys}/></tr>\n    //     })\n    // }\n    getRowsData = function () {\n        console.log(\"CALLING getRowsData\");\n        let isAPICallDone = this.state.apiStatus;\n\n        // console.log(\"getRowsData myItems \",myItems);\n        console.log(\"isAPICallDone  \", isAPICallDone);\n        if (isAPICallDone === \"SUCCESS\") {\n            let myItems = JSON.parse(this.state.apiResponse);\n            let keys = this.getDataKeys();\n            console.log(\"INSIDE IF isAPICallDone getRowsData myItems length \", myItems.length);\n            console.log(\"INSIDE IF isAPICallDone getRowsData myItems  \", myItems);\n            return myItems.map((row, index) => {\n                console.log(\"row is \", row);\n                return <tr key={index}><RenderRow key={index} data={row} keys={keys}/></tr>\n            })\n            // myItems.map((myItem) => {\n            //     console.log(\"********* Iterating getRowsData myItem \",myItem);\n            // });\n\n\n        } else {\n            console.log(\" *********** EMPTY EMPTY ROW CREATED\");\n            return <tr></tr>;\n        }\n\n    }\n\n    render() {\n        return (\n            <div className=\"view-body\">\n                {this.props.session.isLoggedIn ? (\n                    <div className=\"container\">\n                        <div className=\"row\">\n                            <div className=\"col-md-3\">\n                                <Link to=\"/\">Home</Link>\n                            </div>\n                            <div className=\"col-md-3\">\n                                <Link to=\"/files/upload\">Upload File</Link>\n                            </div>\n                            <div className=\"col-md-3\">\n                                <Link to=\"/files/update\">Update Existing File</Link>\n                            </div>\n                        </div>\n                        <MDBTable className=\"table table-bordered\">\n                            <MDBTableHead>\n                                <tr>\n                                    {this.getHeader()}\n                                </tr>\n                            </MDBTableHead>\n                            <MDBTableBody>\n                                {this.getRowsData()}\n                            </MDBTableBody>\n                        </MDBTable>\n                        <a className=\"Home-link\" href=\"#\" onClick={this.onSignOut}>Sign out</a>\n                    </div>\n                ) : (\n                    <div>\n                        <p>You are not logged in.</p>\n                        <a className=\"Home-link\" href={cognitoUtils.getCognitoSignInUri()}>Sign in</a>\n                    </div>\n                )}\n            </div>\n        )\n    }\n}\n\nconst RenderRow = (props) => {\n    console.log(\"RenderRow props \", props);\n    return props.keys.map((key, index) => {\n        console.log(\"props.data[key] \", props.data[key]);\n        console.log(\"key \", key);\n        if (key === 'user_file_name') {\n            let downloadUrl = appConfig.cloudfrontUri + props.data['unique_file_name'];\n            console.log(\"downloadUrl = \",downloadUrl);\n            return <td key={uuid()}><a href={downloadUrl}> {props.data[key]}</a></td>\n        } else if(key === 'delete_button') {\n            return <td key={uuid()}><DeleteButton onClick ={this.deleteFileRow()} index={props.data['id']} /></td>\n\n        } else\n            return <td key={uuid()}>{props.data[key]}</td>\n    })\n}\n\n\nexport default connect(mapStateToProps)(ViewFiles)\n"]},"metadata":{},"sourceType":"module"}